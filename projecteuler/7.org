#+TITLE: Problem 7
#+subtitle: 第 10001 个质数是什么
#+DATE: [2019-02-20 Web 03:10]--[2025-12-09 Tue 11:43]
#+DESCRIPTION: 第 10001 个质数是什么
#+FILETAGS: #prime#

* Problem

*[[https://projecteuler.net/problem=7][10001st prime]]*

By listing the first six prime numbers: 2, 3, 5, 7, 11, and 13, we can see that the 6th prime is 13.

What is the 10 001st prime number?

*第 10001 个质数*

前 6 个质数分别是 2、3、5、7、11 和 13。

第 10001 个质数是多少？

* Solution

不需要编程的方法是查素数表，不过这里我们还是先写出最基础的方法：

#+BEGIN_SRC elisp
  (defun eu7-primep (n)
    (cond
     ((<= n 1) nil)
     ((= n 2) t)
     ((= n 3) t)
     ((or (zerop (% n 2)) (zerop (% n 3)) (zerop (% n 5))) nil)
     (t (let ((bound (floor (sqrt n))))
          (cl-loop for i from 3 by 2
                   when (> i bound) return t
                   when (zerop (% n i)) return nil)))))
  (let ((cnt 3))
    (cl-loop for i from 7 by 2
             when (eu7-primep i) do (incf cnt)
             when (= cnt 10001) return i))
  ;;=> 104743
#+END_SRC

下面是一个高度优化的判断素数函数：

#+BEGIN_SRC elisp
  (defun eu7-isprime (n)
    (cond
     ((<= n 1) nil)
     ((< n 4) t)
     ((zerop (% n 2)) nil)
     ((< n 9) t)
     ((zerop (% n 3)) nil)
     (t (let ((bound (floor (sqrt n))))
          (cl-loop for i from 5 by 6
                   when (> i bound) return t
                   when (or (zerop (% n i))
                            (zerop (% n (+ i 2))))
                   return nil)))))
  (let ((cnt 3))
    (cl-loop for i from 7 by 2
             when (eu7-isprime i) do (incf cnt)
             when (= cnt 10001) return i))
  ;;=> 104743
#+END_SRC

对于不确定上限的素数判定，这已经是一个非常好的判定函数了，如果上限确定，我们可以使用各种筛法。比如埃氏筛或欧拉筛。也许我会在之后的题目中展示高度优化的筛法实现。

我们当然也可以使用一些理论来确定素数的分布：[[https://mathworld.wolfram.com/PrimeNumberTheorem.html][Prime Number Theorem]]。
